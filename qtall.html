<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Qtall - Video Sharing Platform</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
<style>
body {
    font-family: 'Inter', sans-serif;
    margin: 0;
    padding: 0;
    background: #f0f2f5;
    color: #333;
}
header {
    background: #3b82f6;
    color: white;
    padding: 20px;
    text-align: center;
    font-size: 2em;
    font-weight: 600;
    box-shadow: 0 2px 6px rgba(0,0,0,0.2);
}
.navbar {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin-bottom: 20px;
}
.navbar button {
    padding: 10px 20px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    font-weight: 600;
    background: #3b82f6;
    color: white;
    transition: 0.2s;
}
.navbar button:hover { background: #2563eb; }
.container { max-width: 1000px; margin: 0 auto 30px; padding: 20px; }
.section { display: none; }
.visible { display: block; }
input, select, button { width: 100%; padding: 10px; margin: 8px 0; border-radius: 5px; border:1px solid #ccc; font-size:1em; }
button { cursor: pointer; transition: 0.2s; }
button:hover { opacity: 0.9; }
.message { text-align: center; font-weight: 600; margin: 5px 0; }
.message.success { color: #16a34a; }
.message.error { color: #dc2626; }
.video-grid { display: grid; grid-template-columns: 1fr; gap: 20px; }
@media(min-width: 700px){ .video-grid { grid-template-columns: 1fr 1fr; } }
@media(min-width: 1000px){ .video-grid { grid-template-columns: 1fr 1fr 1fr; } }
.video-box {
    border:1px solid #ddd;
    padding:10px;
    border-radius:10px;
    background:white;
    box-shadow:0 2px 6px rgba(0,0,0,0.1);
    position: relative;
}
.video-box b { display:block; margin-bottom:5px; font-size:1.1em; }
.video-box video {
    width: 100%;
    height: auto;
    aspect-ratio: 16 / 9;
    display: block;
    border-radius: 8px;
    margin-bottom: 10px;
}
.video-box button {
    position:absolute;
    top:10px;
    right:10px;
    width:auto;
    padding:5px 10px;
    font-size:0.9em;
    background:#ef4444;
    color:white;
    border:none;
    border-radius:5px;
}
.video-box button:hover { background:#b91c1c; }
h2 { text-align:center; color:#1e3a8a; margin-bottom:15px; }
</style>
</head>
<body>

<header>Qtall - Video Sharing Platform</header>

<div class="navbar">
    <button onclick="showSection('uploadSection')">Upload</button>
    <button onclick="showMyVideos()">My Videos</button>
    <button onclick="showFeed()">Feed</button>
    <button onclick="deleteAccount()" style="background:#ef4444">Delete Account</button>
    <button onclick="logout()" style="background:#6b7280">Logout</button>
</div>

<div class="container">

<!-- SIGN UP -->
<div id="signupSection" class="section visible">
    <h2>Create Account</h2>
    <input type="text" id="newUser" placeholder="Username">
    <input type="password" id="newPass" placeholder="Password">
    <button onclick="createAccount()">Create Account</button>
    <p id="signupMsg" class="message success"></p>
    <p class="message" style="text-align:center;">
        <button onclick="showSection('loginSection')">Go to Login</button>
    </p>
</div>

<!-- LOGIN -->
<div id="loginSection" class="section">
    <h2>Login</h2>
    <select id="loginUser"></select>
    <input type="password" id="loginPass" placeholder="Password">
    <button onclick="login()">Login</button>
    <p id="loginMsg" class="message error"></p>
</div>

<!-- UPLOAD VIDEO -->
<div id="uploadSection" class="section">
    <h2>Upload Video</h2>
    <input type="file" id="videoInput" accept="video/*">
    <input type="text" id="videoTitle" placeholder="Video Title">
    <button onclick="uploadVideo()">Upload</button>
    <!-- Confirmation/Error message -->
    <p id="uploadMsg" class="message"></p>
</div>

<!-- MY VIDEOS -->
<div id="myVideosSection" class="section">
    <h2>My Videos</h2>
    <div id="myVideosList" class="video-grid"></div>
</div>

<!-- FEED -->
<div id="feedSection" class="section">
    <h2>Qtall Feed</h2>
    <div id="feedList" class="video-grid"></div>
</div>

</div>

<script>
// DATA
let accounts = JSON.parse(localStorage.getItem("accounts")) || {};
let currentUser = localStorage.getItem("currentUser") || null;

// UI NAVIGATION
function showSection(id){
    document.querySelectorAll('.section').forEach(s=>s.classList.remove('visible'));
    document.getElementById(id).classList.add('visible');
    populateDropdown();
}

function populateDropdown(){
    const loginList = document.getElementById("loginUser");
    loginList.innerHTML="";
    for(let u in accounts){
        let op=document.createElement("option");
        op.value=u; op.textContent=u;
        loginList.appendChild(op);
    }
}

// SIGNUP
function createAccount(){
    const user = newUser.value.trim();
    const pass = newPass.value.trim();
    if(!user || !pass){ signupMsg.textContent="Fill all fields."; return;}
    if(accounts[user]){ signupMsg.textContent="Username exists."; return;}
    accounts[user]={password:pass,videos:[]};
    localStorage.setItem("accounts",JSON.stringify(accounts));
    signupMsg.textContent="✅ Account created!";
    populateDropdown();
}

// LOGIN
function login(){
    const user = loginUser.value;
    const pass = loginPass.value;
    if(accounts[user] && accounts[user].password === pass){
        currentUser = user;
        localStorage.setItem("currentUser",currentUser);
        showSection('uploadSection');
        loginMsg.textContent="";
    } else { loginMsg.textContent="❌ Incorrect password!"; }
}

// LOGOUT
function logout(){
    currentUser=null;
    localStorage.removeItem("currentUser");
    showSection('loginSection');
}

// UPLOAD VIDEO with visible confirmation
function uploadVideo(){
    const file = videoInput.files[0];
    const title = videoTitle.value.trim();
    const msg = document.getElementById("uploadMsg");

    if(!file || !title){ 
        msg.textContent = "❌ Please select a video and enter a title.";
        msg.className = "message error";
        return;
    }

    const reader = new FileReader();
    reader.onload = function(e){
        const base64 = e.target.result;
        accounts[currentUser].videos.push({url:base64,title});
        localStorage.setItem("accounts",JSON.stringify(accounts));
        videoInput.value="";
        videoTitle.value="";

        msg.textContent = "✅ Video uploaded successfully!";
        msg.className = "message success";
        setTimeout(()=>{ msg.textContent=""; msg.className="message"; }, 3000);
    };
    reader.readAsDataURL(file);
}

// MY VIDEOS
function showMyVideos(){
    showSection('myVideosSection');
    const container = document.getElementById("myVideosList");
    container.innerHTML="";
    accounts[currentUser].videos.forEach((v,i)=>{
        let div = document.createElement("div");
        div.className="video-box";
        div.innerHTML=`<b>${v.title}</b><video controls src="${v.url}"></video>
                       <button onclick="deleteVideo(${i})">Delete</button>`;
        container.appendChild(div);
    });
}

// FEED
function showFeed(){
    showSection('feedSection');
    const container=document.getElementById("feedList");
    container.innerHTML="";
    for(let user in accounts){
        accounts[user].videos.forEach((v)=>{
            let div=document.createElement("div");
            div.className="video-box";
            div.innerHTML=`<b>${v.title} - ${user}</b><video controls src="${v.url}"></video>`;
            container.appendChild(div);
        });
    }
}

// DELETE VIDEO
function deleteVideo(index){
    if(confirm("Delete this video?")){
        accounts[currentUser].videos.splice(index,1);
        localStorage.setItem("accounts",JSON.stringify(accounts));
        showMyVideos();
    }
}

// DELETE ACCOUNT
function deleteAccount(){
    if(!currentUser) return alert("No user logged in.");
    if(confirm("Delete account and all videos?")){
        delete accounts[currentUser];
        localStorage.setItem("accounts",JSON.stringify(accounts));
        logout();
        alert("Account deleted.");
    }
}

// INIT
if(currentUser){ showSection('uploadSection'); }
populateDropdown();
</script>

</body>
</html>

